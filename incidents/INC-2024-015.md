---
incident_id: INC-2024-015
severity: high
service: static-assets
date: 2024-04-30
---

# CDN Cache Poisoning Incident

## Summary
CDN cached an error page from origin server and served it to all users for 45 minutes, breaking frontend applications globally.

## Impact
- All web users saw error page
- Mobile apps unable to load assets
- Global user impact across all regions
- Duration: 45 minutes
- Brand reputation damage

## Timeline
- 10:15 UTC: Origin server returned 500 for assets request
- 10:16 UTC: CDN cached the 500 error page
- 10:17 UTC: Support tickets began flooding in
- 10:20 UTC: War room initiated
- 10:25 UTC: Identified cached error page
- 10:30 UTC: Initiated CDN cache purge
- 10:45 UTC: Cache purge completed globally
- 11:00 UTC: Verified full recovery

## Root Cause
During a routine deployment, the origin server temporarily returned HTTP 500 errors. The CDN was configured to cache all responses including errors, with no validation of status codes. The error page was cached for the default TTL of 1 hour.

## Resolution
1. Immediately purged CDN cache globally
2. Reconfigured CDN to not cache 4xx/5xx responses
3. Added cache control headers to error responses
4. Implemented CDN health checks before caching
5. Reduced TTL for critical assets to 5 minutes

## Prevention
- Configure CDN to never cache error responses
- Implement origin health checks with automatic failover
- Add CDN cache validation rules
- Set up CDN cache status monitoring
- Create CDN emergency purge runbook
- Require CDN configuration review for asset changes
- Add synthetic monitoring for CDN-served assets
- Implement stale-while-revalidate caching strategy
